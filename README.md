# Bank Demo Mobile

## Описание

Этот репозиторий содержит демо-стенд мобильного банковского приложения с акцентом на ООП, JWT-аутентификацию и полный набор автотестов на Kotlin и Playwright.

### Что включено

- **Доменная модель мобильного банка**: пользователи, счета, транзакции.
- **JWT-аутентификация**: выдача access/refresh токенов, проверка и обновление сессии.
- **Redis-слой для токенов**: в демо используется in-memory реализация, архитектура подготовлена под Redis.
- **Минималистичный UI**: статическая HTML/CSS-страница в стиле мобильного приложения.
- **Автотесты**:
  - Kotlin + TestNG для бизнес-логики.
  - Playwright для проверки UI-сценариев.

## Архитектура

```
ru.bank.app
├── core        # Singleton контейнер зависимостей
├── model       # Доменные сущности
├── repository  # Репозитории (in-memory реализация)
└── service     # Сервисы аутентификации и операций
```

## Быстрый старт

### Локальный запуск UI (открыть через localhost)

Проект не содержит backend-сервера — UI является статической страницей. Для локального просмотра поднимите простой HTTP-сервер и откройте страницу в браузере:

```bash
python3 -m http.server 8080 --directory src/main/resources/ui
```

Откройте `http://localhost:8080/index.html`.

### Запуск тестов

```bash
./gradlew clean test
```

### Запуск тестов в отдельном контейнере (локально UI отдельно)

Если нужно запускать тесты изолированно, используйте Docker-образ с JDK 17:

```bash
docker run --rm -v "$PWD":/workspace -w /workspace gradle:8.5-jdk17 ./gradlew clean test
```

При этом UI можно продолжать открывать локально через `python3 -m http.server` (см. выше).

### Allure отчёт

```bash
./gradlew allureReport
./gradlew allureServe
```

## Демо UI

UI расположен в `src/main/resources/ui/index.html` и доступен как статическая страница. Playwright тесты используют её для проверки сценария входа.

## Технологии

- Java 17 / Kotlin 1.9
- Gradle 8.5
- TestNG
- Playwright
- Java JWT
- Allure

## Примечания

- Демо использует in-memory хранилища для упрощения запуска.
- JWT секрет вынесен в `AppContainer` и должен быть заменён в продакшене.

## Postman коллекция (контракт API)

В репозитории есть коллекция `postman/BankDemo.postman_collection.json`. Она описывает ожидаемые REST-запросы и логику работы приложения (регистрация, логин, выпуск токенов, создание счёта, дашборд и перевод). Это контракт для тестирования/моков, так как в проекте нет реального backend-сервера.
